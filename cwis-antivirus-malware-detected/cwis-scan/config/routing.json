{
  "auth": [
    {
      "description": "WP REST",
      "mode": "rest",
      "endpoint": "/wp-json/cwis/v5/rest",
      "direct": "/wp-content/plugins/cwis-antivirus-malware-detected/cwis-scan/rest.php",
      "params": {
        "action": "cwis_scanner",
        "restapi": "--cwisRestNonce--",
        "totp": "--TOTP--"
      }
    },
    {
      "description": "WP Admin AJAX Hook, must use action=cwis_scanner",
      "mode": "api",
      "endpoint": "/wp-admin/admin-ajax.php",
      "direct": "/wp-content/plugins/cwis-antivirus-malware-detected/cwis-scan/api.php",
      "params": {
        "action": "cwis_scanner",
        "id": "--cwisAjaxId--",
        "p": "--cwisAjaxPass--"
      }
    }
  ],
  "routes": [
    {
      "name": "Login to admin",
      "description": "Allows remote login to site admin",
      "params": {
        "subaction": "autologin"
      }
    },
    {
      "name": "Info route",
      "description": "All-in-one aggregated results",
      "default": {
        "only": [
          "components",
          "updater",
          "scanner",
          "sysinfo",
          "stats",
          "defender",
          "settings",
          "news"
        ]
      },
      "params": {
        "subaction": "info",
        "only": []
      }
    },
    {
      "name": "News",
      "description": "Get news from dashboard",
      "params": {
        "subaction": "news"
      }
    },
    {
      "name": "Defender Settings",
      "description": "Set Defender Settings",
      "params": {
        "subaction": "defender",
        "cwis_task": "settings",
        "cwis_config": "{\"smartwaf\":true,\"antibot\":1,\"antispam\":1,\"bruteforce\":1,\"hidefunc\":1,\"ipfilter\":{\"allow\":\"\",\"block\":\"\"},\"bitmask\":0,\"remote\":1,\"lists\":0,\"report\":0,\"geo\":\"IL\",\"asn\":\"\",\"rc\":0,\"bots\":\"GGL,YHO,BNG,YNX,FCB,OTH\",\"geo_not\":1,\"blockArr\":[],\"allowArr\":[],\"geoArr\":[\"IL\"],\"botsArr\":[\"GGL\",\"YHO\",\"BNG\",\"YNX\",\"FCB\",\"OTH\"],\"asnArr\":[]}",
        "action": "cwis_scanner"
      }
    },
    {
      "name": "Settings update",
      "description": "Update smart protection settings",
      "params": {
        "subaction": "settings",
        "action": "cwis_scanner"
      }
    },
    {
      "name": "Results",
      "description": "Get Scanner Results",
      "params": {
        "subaction": "results"
      }
    },
    {
      "name": "Scan Hashes",
      "description": "Get scanned file hashes",
      "params": {
        "subaction": "hashes"
      }
    },
    {
      "name": "Ping",
      "description": "Site ping endpoint",
      "params": {
        "subaction": "ping"
      }
    },
    {
      "name": "Components",
      "description": "Get components",
      "params": {
        "subaction": "components",
        "start": null
      }
    },
    {
      "name": "Components enable",
      "description": "Enable components",
      "params": {
        "subaction": "components",
        "cwis_task": "enable",
        "components": []
      }
    },
    {
      "name": "Components upgrade",
      "description": "Upgrade components",
      "params": {
        "subaction": "components",
        "cwis_task": "upgrade",
        "components": []
      }
    },
    {
      "name": "Components disable",
      "description": "Disable components",
      "params": {
        "subaction": "components",
        "cwis_task": "disable",
        "components": []
      }
    },
    {
      "name": "Explorer",
      "description": "Files table",
      "params": {
        "draw": "1",
        "columns": {},
        "order": [
          {
            "column": "1",
            "dir": "asc"
          }
        ],
        "start": "0",
        "length": "100",
        "search": {
          "value": "",
          "regex": "false"
        },
        "filters": {
          "ext": [
            "mp3",
            "wav",
            "m4a",
            "flac",
            "mp4",
            "ogg",
            "webm",
            "mpg",
            "ogv",
            "m4v",
            "asf",
            "avi",
            "flv",
            "swf",
            "css",
            "webp",
            "jpeg",
            "svg",
            "jpg",
            "png",
            "gif",
            "raw",
            "bmp",
            "eot",
            "ttf"
          ],
          "types": [
            "BigFiles",
            "match",
            "BigFiles",
            "SkippedDirs",
            "Whitelisted",
            "quarantine"
          ],
          "query_logic": "1",
          "show_matching": "-1",
          "show_missing": "-1",
          "show_anomalies": "-1",
          "show_quarantine": "-1",
          "show_expanded": "0",
          "expand_matching_core": "0",
          "expand_matching_plugins": "0",
          "expand_matching_themes": "0",
          "expand_missing_core": "1",
          "expand_missing_plugins": "0",
          "expand_missing_themes": "0",
          "expand_quarantine_folders": "0"
        },
        "action": "cwis_scanner",
        "subaction": "explorer"
      }
    },
    {
      "name": "Tree",
      "description": "Files viewer -- Tree Mode",
      "params": {
        "action": "cwis_scanner",
        "subaction": "tree",
        "node": {
          "id": "#",
          "parent": ""
        },
        "filters": {
          "ext": [
            "mp3",
            "wav",
            "m4a"
          ],
          "types": [
            "BigFiles",
            "match",
            "BigFiles",
            "SkippedDirs",
            "Whitelisted",
            "quarantine"
          ],
          "query_logic": "1",
          "show_matching": "-1",
          "show_missing": "-1",
          "show_anomalies": "-1",
          "show_quarantine": "-1",
          "show_expanded": "0",
          "expand_matching_core": "0",
          "expand_matching_plugins": "0",
          "expand_matching_themes": "0",
          "expand_missing_core": "1",
          "expand_missing_plugins": "0",
          "expand_missing_themes": "0",
          "expand_quarantine_folders": "0"
        }
      }
    },
    {
      "name": "File Read",
      "description": "Read a file",
      "params": {
        "subaction": "file_read",
        "fn": "Base 64 encoded filename"
      }
    },
    {
      "name": "Files Chmod",
      "description": "Read a file",
      "params": {
        "subaction": "file_chmod",
        "files": [
          "array of files"
        ],
        "octal": "644"
      }
    },
    {
      "name": "File Write",
      "description": "Write a file",
      "params": {
        "subaction": "file_write",
        "fn": "Base 64 encoded filename",
        "data": "Base 64 encoded contents"
      }
    },
    {
      "name": "Sitecheck",
      "description": "Run a remote sitecheck",
      "params": {
        "subaction": "sitecheck"
      }
    },
    {
      "name": "Archive Local",
      "description": "Archive local files/directories",
      "params": {
        "subaction": "archive_local",
        "files": [],
        "folders": []
      }
    },
    {
      "name": "Archive Local RM",
      "description": "Remove locally generated archive file",
      "params": {
        "subaction": "archive_local_rm",
        "files": [],
        "folders": []
      }
    },
    {
      "name": "Archive Remote",
      "description": "Receive remote archive for file replace",
      "params": {
        "subaction": "archive_remote",
        "files": [],
        "folders": []
      }
    },
    {
      "name": "Archive Remote",
      "description": "Remote accept / replace",
      "params": {
        "subaction": "archive_check",
        "files": [],
        "folders": []
      }
    },
    {
      "name": "Archive Reset",
      "description": "Replace files / folders from the archive",
      "params": {
        "subaction": "archive_reset",
        "files": [],
        "folders": []
      }
    },
    {
      "name": "Quarantine List",
      "description": "Lists files currently in quarantine",
      "params": {
        "subaction": "quarantine_list"
      }
    },
    {
      "name": "Quarantine Add",
      "description": "Adds files to quarantine",
      "params": {
        "subaction": "quarantine_add",
        "files": []
      }
    },
    {
      "name": "Quarantine Restore",
      "description": "Restores files from quarantine",
      "params": {
        "subaction": "quarantine_restore",
        "files": []
      }
    },
    {
      "name": "Whitelist list",
      "description": "Lists whitelisted files",
      "params": {
        "subaction": "whitelist_list"
      }
    },
    {
      "name": "Whitelist add",
      "description": "Whitelist add files",
      "params": {
        "subaction": "whitelist_add",
        "files": []
      }
    },
    {
      "name": "Whitelist remove",
      "description": "Whitelist remove files",
      "params": {
        "subaction": "whitelist_remove",
        "files": []
      }
    },
    {
      "name": "Dashboard Sync",
      "description": "Syncs all data with dashboard",
      "defaults": {
        "step": "1 -- Components, 2 -- Hashes, 3 - Results.., 4 - Remote.."
      },
      "params": {
        "subaction": "sync",
        "step": 1
      }
    },
    {
      "name": "Scanner Settings Get",
      "description": "Get scanner settings",
      "defaults": {},
      "params": {
        "subaction": "scheduler",
        "cwis_task": "view"
      }
    },
    {
      "name": "Scanner Settings Set",
      "description": "Sets persistent scanner settings",
      "defaults": {},
      "params": {
        "subaction": "scheduler",
        "cwis_task": "change"
      }
    },
    {
      "name": "Defender Stats",
      "description": "Defenter stats chart",
      "params": {
        "subaction": "defender",
        "cwis_task": "stats"
      }
    },
    {
      "name": "License Auth",
      "description": "Checks license file",
      "params": {
        "subaction": "license",
        "cwis_task": "auth"
      }
    },
    {
      "name": "License Register",
      "description": "Register License",
      "params": {
        "subaction": "license",
        "cwis_task": "register",
        "name": "Name",
        "email": "Email"
      }
    },
    {
      "name": "License Verify",
      "description": "Verify License",
      "params": {
        "subaction": "license",
        "cwis_task": "verify",
        "lkey": "-- LICENSE KEY--"
      }
    },
    {
      "name": "Log Viewer",
      "description": "View 1 of 4 log types",
      "options": {
        "cwis_log_type": [
          "debug",
          "errors",
          "prescan",
          "rescan"
        ]
      },
      "params": {
        "subaction": "logviewer",
        "cwis_log_type": "debug",
        "cwis_log_lines": 100
      }
    },
    {
      "name": "Scanner",
      "description": "Main scanner endpoint",
      "options": {
        "cwis_log_type": [
          "debug",
          "errors",
          "prescan",
          "rescan"
        ]
      },
      "params": {
        "subaction": "scanner",
        "apimode": "0",
        "autopath": "1",
        "autostart": "1",
        "database": "1",
        "depth": "88",
        "easing": "24",
        "email": "aa@bb.com",
        "extskip": [
          "mp3",
          "wav",
          "m4a"
        ],
        "filter": "",
        "frequency": "3",
        "filterexp": "0",
        "filterinv": "0",
        "lang": "en",
        "level": "-1",
        "promode": "1",
        "scanpath": "",
        "secvuln": "0",
        "sendalerts": "1",
        "sendreports": "1",
        "timeout": "2",
        "scantype": "0"
      }
    },
    {
      "name": "System Info",
      "description": "Returns system information",
      "params": {
        "subaction": "sysinfo"
      }
    },
    {
      "name": "Debug",
      "description": "Internal debug actions",
      "params": {
        "subaction": "debug"
      }
    },
    {
      "name": "Updater",
      "description": "Run plugin update for specified slug",
      "params": {
        "subaction": "updater"
      }
    },
    {
      "name": "Register",
      "description": "Internal",
      "params": {
        "subaction": "register"
      }
    },
    {
      "name": "Reset",
      "description": "Resets plugin data",
      "options": {
        "rst": [
          "results",
          "sitecheck",
          "settings"
        ]
      },
      "params": {
        "subaction": "reset",
        "rst": "licence"
      }
    },
    {
      "name": "Blacklist",
      "description": "Blacklist geo and ips",
      "params": {
        "subaction": "blacklist"
      }
    }
  ]
}
