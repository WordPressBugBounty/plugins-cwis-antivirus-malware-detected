<?php

namespace App\Library;

class Cwis_Defender_Config
{

    /**
     * List of replacement paths and keys used for converting and routing,
     * each replacement key must be 2 characters long.
     *
     * @since    1.0.0
     * @access   public
     * @var      array    $url_replacement_list
     */
    public $url_replacement_list = array(
        '/wp-content/cache/'   => 'cc',
        '/wp-content/plugins/' => 'cp',
        '/wp-content/themes/'  => 'ct',
        '/wp-content/uploads/' => 'cu',
        '/wp-content/'         => 'c_',
        '/wp-includes/css/'    => 'ic',
        '/wp-includes/fonts/'  => 'if',
        '/wp-includes/images/' => 'ii',
        '/wp-includes/js/'     => 'ij',
        '/wp-includes/'        => 'i_'
    );

    /**
     * Fallback for servers without Fileinfo, mime_content_type, or PEAR support.
     *
     * @since    1.0.0
     * @access   public
     * @var      array    $mime_types_map
     */
    public $mime_types_map = array(
    );

    /**
     * Checks if one of the replacement URLs contains the input path.
     *
     * @since   4.1.5
     * @access  public
     *
     * @param   string $path
     * @return  bool
     */
    public function is_url_replacement_path($path = '')
    {
        $lcpath = strtolower($path);
        foreach ($this->url_replacement_list as $url => $key) {
            if (false !== strpos($lcpath, $url)) {
                return true;
            }
        }

        return false;
    }

}
