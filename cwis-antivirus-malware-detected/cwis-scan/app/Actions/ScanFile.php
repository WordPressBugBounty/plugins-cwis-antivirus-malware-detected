<?php

namespace App\Actions;

use App\State;

class ScanFile extends BaseAction
{
    public function __invoke($params): array
    {
        $file = $params['path'];
        $app = State::cwisApp();
        $app->initScannerMethods();

        $app->scanner->loadIgnoredExt();
        $app->scanner->loadIgnoreLists();
        $app->scanner->loadOptimizeSignatures();
        $app->scanner->scanFile($file);
        $result = $app->scanner->results;

        return $result->result ?? [];
    }
}
