<?php

namespace App\Actions;

class Ping extends BaseAction
{
    public function __invoke(): array
    {
        $result = [ 'time' => time() ];
        $uptime_content = empty(ini_get('open_basedir')) && is_readable('/proc/uptime') ?
            @file_get_contents('/proc/uptime') : false;

        if ($uptime_content === false) {
            $result['uptime'] = [0,0,0,0];
        } else {
            $num   = floatval($uptime_content);
            $secs  = fmod($num, 60); $num = (int)($num / 60);
            $mins  = $num % 60;      $num = (int)($num / 60);
            $hours = $num % 24;      $num = (int)($num / 24);
            $days  = $num;
            $result['uptime'] = [ $days, $hours, $mins, $secs ];
        }

        return $result;
    }
}
